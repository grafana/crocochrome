name: Approve renovate PRs

on:
  pull_request:

jobs:
  approve:
    permissions:
      # Needed for logging into vault.
      contents: read
      id-token: write
    runs-on: ubuntu-latest
    # Do not bother running if PR is not authored by grafanarenovatebot.
    # https://woodruffw.github.io/zizmor/audits/#bot-conditions
    if: github.event.pull_request.user.login == 'renovate-sh-app[bot]' && github.repository == github.event.pull_request.head.repo.full_name
    steps:
      - uses: grafana/sm-renovate/actions/renovate-approve@8dbe4a6ff27443b65e84410aca225751b3638ff8
        with:
          renovate-user: 'renovate-sh-app[bot]'
